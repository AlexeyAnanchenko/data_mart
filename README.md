# data_mart

## Задание на составление витрины из базы данных в рамках курса "Инженер данных" от 1Т

Составленная схема БД представлена на ER-диаграмме по ссылке: (<code>[./ER-diagram.png](https://github.com/AlexeyAnanchenko/data_mart/blob/main/ER-diagram.png)</code>)

Скрипт запроса на создание витрины: (<code>[scripts_db/DML/query_for_data_mart.sql](https://github.com/AlexeyAnanchenko/data_mart/blob/main/scripts_db/DML/query_for_data_mart.sql)</code>)

## Как развернуть проект?

Для просмотра проекта достаточно склонировать его себе на локальный компьютер, иметь установленным docker-compose и ввести команду:

```sh
docker-compose up -d
```

Далее база данных доступна в контейнере, либо по порту 5432 из любого сервиса для подключения к БД (например, DBeaver)

## ТЗ для составления витрины данных:

Аналитикам нужно оценить, насколько отдел планирования хорошо делает свою работу. Для этого вам необходимо разработать SQL-скрипт, который формирует таблицу со следующим набором атрибутов:

shop_name — название магазина,
product_name — название товара,
sales_fact — количество фактических продаж на конец месяца,
sales_plan — количество запланированных продаж на конец месяца,
sales_fact/sales_plan — отношение количества фактических продаже к запланированному,
income_fact — фактический доход,
income_plan — планируемый доход,
income_fact/income_plan — отношение фактического дохода к запланированному.
avg(sales/date) - среднее количество продаж в день,
max_sales - максимальное количество продаж за один день,
date_max_sales - день, в который произошло максимальное количество продаж,
date_max_sales_is_promo - факт того, действовала ли скидка в тот день, когда произошло максимальное количество продаж,
avg(sales/date) / max_sales - отношение среднего количества продаж к максимальному,
promo_len - количество дней месяце когда на товар действовала скидка,
promo_sales_cnt - количество товаров проданных в дни скидок,
promo_sales_cnt/fact_sales - отношение количества товаров проданных в дни скидки к общему количеству проданных товаров за месяц,
promo_income - доход с продаж в дни акций,
promo_income/fact_income - отношение дохода с продаж в дни акций к общему доходу с продаж за месяц
